<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TEST - Modal DevoluciÃ³n</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            padding: 40px;
            font-family: Inter, sans-serif;
        }
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
        }
        .big-button {
            padding: 24px 48px;
            font-size: 20px;
            font-weight: bold;
            background: #22c55e;
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            margin: 20px 0;
            transition: all 0.3s;
        }
        .big-button:hover {
            background: #16a34a;
            transform: scale(1.05);
        }
        .status {
            padding: 16px;
            background: #f3f4f6;
            border-radius: 8px;
            margin: 20px 0;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ§ª TEST Modal DevoluciÃ³n</h1>
        <p>Esta pÃ¡gina NO usa Service Worker. Si funciona aquÃ­, el problema es el cachÃ©.</p>
        
        <button class="big-button" onclick="testModal()">
            ğŸ”„ ABRIR MODAL DEVOLUCIÃ“N
        </button>
        
        <div class="status" id="status">
            Presiona el botÃ³n para probar...
        </div>
    </div>

    <!-- MODAL: Registrar DevoluciÃ³n -->
    <div id="modalDevolucion" class="modal">
        <div class="modal-overlay" onclick="cerrarModalDevolucion()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ”„ Registrar DevoluciÃ³n de Producto</h3>
                <button class="btn-close" onclick="cerrarModalDevolucion()">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M15 5L5 15M5 5l10 10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="alert alert-warning" style="margin-bottom: 20px;">
                    <strong>âš ï¸ Registro Manual de DevoluciÃ³n</strong><br>
                    Este formulario NO incrementa el stock automÃ¡ticamente. Solo queda registrado en la consola para control interno.
                </div>

                <form id="formDevolucion" onsubmit="registrarDevolucion(event)">
                    <div class="form-group">
                        <label for="devolucionProducto">Nombre del Producto *</label>
                        <input type="text" 
                               id="devolucionProducto" 
                               class="form-input" 
                               placeholder="Ej: Champion Adulto 18kg"
                               required
                               autocomplete="off">
                    </div>

                    <div class="form-group">
                        <label for="devolucionCantidad">Cantidad *</label>
                        <input type="number" 
                               id="devolucionCantidad" 
                               class="form-input" 
                               placeholder="1" 
                               min="1" 
                               max="100"
                               value="1"
                               required>
                    </div>

                    <div class="form-group">
                        <label for="devolucionMotivo">Motivo de DevoluciÃ³n *</label>
                        <select id="devolucionMotivo" class="form-select" required>
                            <option value="">Seleccionar motivo...</option>
                            <option value="Error de entrega">âŒ Error de entrega</option>
                            <option value="Producto equivocado">ğŸ”„ Producto equivocado</option>
                            <option value="Cliente devolviÃ³">ğŸ‘¤ Cliente devolviÃ³</option>
                            <option value="Producto defectuoso">âš ï¸ Producto defectuoso</option>
                            <option value="Cambio de pedido">ğŸ“ Cambio de pedido</option>
                            <option value="Sobrante de bodega">ğŸ“¦ Sobrante de bodega</option>
                            <option value="Otro">ğŸ“‹ Otro</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="devolucionObservaciones">Observaciones (opcional)</label>
                        <textarea id="devolucionObservaciones" 
                                  class="form-input" 
                                  placeholder="Detalles adicionales sobre la devoluciÃ³n..."
                                  rows="3"
                                  style="resize: vertical;"></textarea>
                    </div>

                    <button type="submit" class="btn btn-success btn-block">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M5 13l4 4L19 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span>Registrar DevoluciÃ³n</span>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        let currentUser = 'TEST USER';

        function testModal() {
            const status = document.getElementById('status');
            status.innerHTML = 'ğŸ”µ Intentando abrir modal...';
            
            console.log('ğŸ”µ FUNCIÃ“N LLAMADA: testModal()');
            
            const modal = document.getElementById('modalDevolucion');
            console.log('ğŸ”µ Modal encontrado:', modal);
            
            if (!modal) {
                status.innerHTML = 'âŒ ERROR: Modal no encontrado en el DOM';
                alert('âŒ Modal no encontrado');
                return;
            }
            
            modal.classList.add('active');
            status.innerHTML = 'âœ… Modal abierto correctamente!';
            console.log('âœ… Modal abierto');
        }

        function cerrarModalDevolucion() {
            const modal = document.getElementById('modalDevolucion');
            if (modal) {
                modal.classList.remove('active');
            }
            
            const form = document.getElementById('formDevolucion');
            if (form) {
                form.reset();
            }
            
            document.getElementById('status').innerHTML = 'âœ… Modal cerrado';
        }

        function registrarDevolucion(event) {
            event.preventDefault();
            
            const producto = document.getElementById('devolucionProducto').value.trim();
            const cantidad = parseInt(document.getElementById('devolucionCantidad').value);
            const motivo = document.getElementById('devolucionMotivo').value;
            const observaciones = document.getElementById('devolucionObservaciones').value.trim();
            
            console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
            console.log('ğŸ”„ DEVOLUCIÃ“N REGISTRADA (TEST)');
            console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
            console.log('ğŸ“… Fecha:', new Date().toLocaleString('es-CL'));
            console.log('ğŸ‘¤ Vendedor:', currentUser);
            console.log('ğŸ“¦ Producto:', producto);
            console.log('ğŸ”¢ Cantidad:', cantidad);
            console.log('ğŸ“ Motivo:', motivo);
            console.log('ğŸ’¬ Observaciones:', observaciones || 'Ninguna');
            console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
            
            alert(`âœ… DevoluciÃ³n registrada: ${cantidad}x ${producto}`);
            
            cerrarModalDevolucion();
        }
    </script>
</body>
</html>
